






<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2024-10-16 05:53:54 -0400">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />
    
    <link rel="license" href="#license-info" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/swc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/swc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/swc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/swc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/swc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/swc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/swc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/swc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Software Carpentry - Single Cell RNAseq"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/swc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/swc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/swc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/swc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/swc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

  <title>
  Overview of scRNA-seq Data &ndash; Single Cell RNAseq
  </title>  

  </head>
  <body>

    








    <div class="container">
      
















  
  










<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/swc-icon-blue.svg" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            
            <li><a href="../01-introduction/index.html">Introduction to Single Cell RNA-seq</a></li>
            
            
            <li><a href="../02-Experimental-Considerations/index.html">Experimental Considerations</a></li>
            
            
            <li><a href="../03-Overview-scRNA-seq-Data/index.html">Overview of scRNA-seq Data</a></li>
            
            
            <li><a href="../04-Quality-Control/index.html">Quality Control of scRNA-Seq Data</a></li>
            
            
            <li><a href="../05-Common-Analyses/index.html">Common Analyses</a></li>
            
            
            <li><a href="../06-Biology-Driven-Analyses/index.html">Biology Driven Analyses of scRNA-Seq</a></li>
            
            
            <li><a href="../07-Analyzing-Your-Data/index.html">Analyzing Your Data</a></li>
            
            
            <li><a href="../08-Future-Directions/index.html">Future Directions</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
        
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            
            
              <li><a href="../about/index.html">About</a></li>
            
            
            
            
              <li><a href="../discuss/index.html">Discussion</a></li>
            
            
            
            
              <li><a href="../figures/index.html">Figures</a></li>
            
            
            
            
              <li><a href="../guide/index.html">Instructor Notes</a></li>
            
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	
	<li><a href="/edit//_episodes_rmd/03-Overview-scRNA-seq-Data.Rmd" data-checker-ignore>Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>



















  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../02-Experimental-Considerations/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Single Cell RNAseq</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../04-Quality-Control/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Overview of scRNA-seq Data</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>












<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 90 min
      <br/>
      <strong>Exercises:</strong> 30 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What does single cell RNA-Seq data look like?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Understand the types of files provided by CellRanger.</p>
</li>
	
	<li><p>Understand the structure of files provided by CellRanger.</p>
</li>
	
	<li><p>Describe a sparse matrix and explain why it is useful.</p>
</li>
	
	<li><p>Read in a count matrix using Seurat.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="overview-of-single-cell-analysis-process">Overview of Single Cell Analysis Process</h2>

<p><img src="../fig/single_cell_flowchart_0.png" width="800px" alt="Single Cell Flowchart" /></p>

<h2 id="open-project-file">Open Project File</h2>

<p>In the Setup section of this workshop, you created an RStudio Project. 
Open this project now, by:</p>

<ol>
  <li>selecting File –&gt; Open Project… from the Menu</li>
  <li>choosing “scRNA.Rproj”</li>
  <li>opening the project file.</li>
</ol>

<h2 id="what-do-raw-scrna-seq-data-look-like">What do raw scRNA-Seq data look like?</h2>

<p>The raw data for an scRNA-Seq experiment typically consists of two FASTQ files.
One file contains the sequences of the cell barcode and molecular
barcode (UMI), while the other file contains the sequences derived from
the transcript. The reads in file one are approximately 28bp long 
(16bp cell barcode, 12bp UMI), while the reads in file two are 
approximately 90bp long.</p>

<p>The Single Cell Biology Laboratory at JAX additionally provides output
of running the 
<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">10X CellRanger pipeline</a> 
(see below).</p>

<h2 id="typical-pre-processing-pipeline">Typical pre-processing pipeline</h2>

<h3 id="10x-cellranger">10X CellRanger</h3>

<p><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">10X CellRanger</a> 
is “a set of analysis pipelines that process Chromium single cell 
data to align reads, generate feature-barcode matrices” and perform
various other downstream analyses.
In this course we will work with data that has been preprocessed 
using CellRanger.
All you need to remember is that we used CellRanger to obtain
gene expression counts for each gene within each cell.</p>

<h3 id="cellranger-alternatives">CellRanger alternatives</h3>

<p>There are several alternatives to CellRanger. Each of these alternatives
has appealing properties that we encourage you to read about but do not
have the time to discuss in this course. Alternatives include:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">alevin</code> <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1670-y">Srivastava et al. 2019</a>, 
 from the developers of the <code class="language-plaintext highlighter-rouge">salmon</code> aligner</li>
  <li><code class="language-plaintext highlighter-rouge">kallisto | bustools</code> <a href="https://doi.org/10.1038/s41587-021-00870-2">Melsted et al. 2021</a>, 
 from the developers of the <code class="language-plaintext highlighter-rouge">kallisto</code> aligner</li>
  <li><code class="language-plaintext highlighter-rouge">STARsolo</code> <a href="https://doi.org/10.1101/2021.05.05.442755">Kaminow et al 2021</a>, 
 from the developers of the <code class="language-plaintext highlighter-rouge">STAR</code> aligner</li>
</ul>

<p>While you should be aware that these alternatives
exist and in some cases there may be very compelling reasons to use them,
broadly speaking CellRanger is the most widely used tool for 
processing 10X Chromium scRNA-Seq data.</p>

<h2 id="introduction-to-two-major-single-cell-analysis-ecosystems">Introduction to two major single cell analysis ecosystems:</h2>

<p>At the time that this workshop was created, there were many different software 
packages designed for analyzing scRNA-seq data in a variety of scenarios. The 
two scRNA-seq software “ecosystems” that were most widely in use were:</p>

<ul>
  <li>R/Seurat : The Seurat ecosystem is the tool of choice for this workshop. The 
biggest strength of Seurat is its straightforward vignettes and ease of 
visualization/exploration.
    <ul>
      <li><a href="https://www.nature.com/articles/nbt.3192">Seurat</a> was released in 2015 
  by the <a href="https://biology.mit.edu/profile/aviv-regev/">Regev lab</a>.</li>
      <li>The first author, Rahul Satija, now has a faculty position and has 
  maintained and improved Seurat.</li>
      <li>Currently at <a href="https://www.cell.com/cell/fulltext/S0092-8674(21)00583-3">version 4</a>.</li>
      <li>Source code available on <a href="https://www.github.com/satijalab/seurat">Github</a>.</li>
      <li>Each version of Seurat adds new functionality:
        <ul>
          <li>Seurat v1: Infers cellular localization by integrating scRNA-seq 
  with <em>in situ</em> hybridization.</li>
          <li>Seurat v2: Integrates multiple scRNA-seq data sets using shared 
  correlation structure.</li>
          <li>Seurat v3: Integrates data from multiple technologies, i.e. scRNA-seq, 
  scATAC-seq, proteomics, <em>in situ</em> hybridization.</li>
          <li>Seurat v4: Integrative multimodal analysis and mapping of user data 
  sets to cell identity reference database.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Python/<a href="https://scanpy.readthedocs.io/en/stable/">scanpy</a> and <a href="https://anndata.readthedocs.io/en/latest/">anndata</a>
    <ul>
      <li>Scanpy is a python toolkit for analyzing single-cell gene expression data.</li>
      <li>Scanpy is built jointly with anndata, which is a file format specification 
  and accompanying API for efficiently storing and accessing single cell data.</li>
      <li>Like Seurat, scanpy is under active development as well. Scanpy has an 
  advantage of being a somewhat larger and more diverse community than
  Seurat, where developement is centered around a single lab group.</li>
      <li>This software has been used in a very large number of single cell projects. We 
  encourage you to check it out and consider using it for your own work.</li>
    </ul>
  </li>
</ul>

<p>For this course we will not use scanpy because we view R/Seurat as 
having a slight edge over scanpy when it comes to visualization and 
interactive exploration of single cell data.</p>

<h2 id="reading-in-cellranger-data">Reading in CellRanger Data</h2>

<p><img src="../fig/single_cell_flowchart_1.png" width="800px" alt="Single Cell Flowchart" /></p>

<p>As described above,
<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">CellRanger</a> 
is software which preprocesses Chromium single cell data to 
align reads, generate feature-bar code matrices, and perform other downstream 
analyses. 
We will not be using any of CellRanger’s downstream analyses,
but we <em>will</em> be using the feature-barcode matrix produced by CellRanger.
A feature-barcode matrix – in the context of scRNA-Seq – is a
matrix that gives gene expression counts for each gene in each single cell.
In a feature-barcode matrix, the 
genes (rows) are the features, and the cells (columns) are each identified
by a barcode.
The name feature-barcode matrix is a generalized term for the
gene expression matrix. For example, feature-barcode could also refer
to a matrix of single cell protein expression or single cell
chromatin accessibility.
In this workshop, we will read in the 
feature-barcode matrix produced by CellRanger and will perform the downstream 
analysis using Seurat.</p>

<h3 id="liver-atlas">Liver Atlas</h3>

<h4 id="cell-ranger-files">Cell Ranger Files</h4>

<p>In this lesson, we will read in a subset of data from the 
<a href="https://livercellatlas.org/index.php">Liver Atlas</a>, which is described in their 
<a href="https://www.cell.com/cell/fulltext/S0092-8674(21)01481-1">Cell paper</a>. 
Briefly, the authors performed scRNASeq on liver cells from mice and humans, 
identified cell types, clustered them, and made the data publicly available. 
We will be working with a subset of the <em>mouse</em> liver data. 
We split the data into two sets, one to use in the lesson and one for 
you to work with independently as a challenge.</p>

<p>Before the workshop, you should have downloaded the data from 
Box and placed it in your <code class="language-plaintext highlighter-rouge">data</code> directory. 
Go to the <a href="../setup">Setup</a> page for instructions on how to download the data 
files.</p>

<p>Open a file browser and look in the <code class="language-plaintext highlighter-rouge">data</code> subdirectory <code class="language-plaintext highlighter-rouge">mouseStSt_invivo</code> and 
you should see three files. Each file ends with ‘gz’, which indicates that it 
has been compressed (or ‘zipped’) using 
<a href="https://www.gnu.org/software/gzip/">gzip</a>. You <strong>don’t</strong> need to unzip them; 
the software that we use will uncompress the files as it reads them in. The 
files are:</p>

<ul>
  <li>matrix.mtx.gz: The feature-barcode matrix, i.e. a two-dimensional 
 matrix containing the counts for each gene in each cell.
    <ul>
      <li>Genes are in rows and cells are in columns.</li>
      <li>This file is in a special sparse matrix format which reduces disk space 
 and memory usage.</li>
    </ul>
  </li>
  <li>barcodes.tsv.gz: DNA barcodes for each cell. Used as column names in counts matrix.</li>
  <li>features.tsv.gz: Gene symbols for each gene. Used as row names in counts matrix.</li>
</ul>

<p><img src="../fig/counts_matrix.png" width="800px" alt="Count Matrix" /></p>

<blockquote class="challenge">
  <h2 id="challenge-1">Challenge 1</h2>
  <p>1). R has a function called <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/file.info.html">file.size</a>. 
Look at the help for this function and get the size of each of the files in 
the <code class="language-plaintext highlighter-rouge">mouseStSt_invivo</code> directory.  Which one is the largest?</p>

  <blockquote class="solution">
    <h2 id="solution-to-challenge-1">Solution to Challenge 1</h2>

    <p>1). <code class="language-plaintext highlighter-rouge">file.size(file.path(data_dir, 'mouseStSt_invivo', 'barcodes.tsv.gz'))</code><br />
    584346 bytes<br />
    <code class="language-plaintext highlighter-rouge">file.size(file.path(data_dir, 'mouseStSt_invivo', 'features.tsv.gz'))</code><br />
    113733 bytes<br />
    <code class="language-plaintext highlighter-rouge">file.size(file.path(data_dir, 'mouseStSt_invivo', 'matrix.mtx.gz'))</code><br />
    603248953 bytes<br />
    ‘matrix.mtx.gz’ is the largest file.</p>
  </blockquote>
</blockquote>

<h4 id="cellranger-quality-control-report">CellRanger Quality Control Report</h4>

<p>CellRanger also produces a Quality Control (QC) report as an HTML
document. It produces one report for each sample we run (each
channel of the 10X chip). We do not have
the QC report from the Liver Atlas study, but the figure below shows an 
example report. The report highlights three numbers:</p>

<ol>
  <li>Estimated Number of Cells: This indicates the number of cells recovered
in your experiment. As we previously discussed this will be less than the
number of cells you loaded. The number of cells recovered
will almost never be the exact number of cells you had hoped to recover,
but we might like to see a number within approximately +/-20% of your goal.</li>
  <li>Mean Reads per Cell: This indicates the number of reads in each cell. 
This will be a function of how deeply you choose to sequence your library.</li>
  <li>Median Genes per Cell: This indicates the median number of genes detected
in each cell. Note that this is much lower than in bulk RNA-Seq. This 
number will also be lower for single nucleus than for single cell
RNA-Seq, and is also likely to vary between cell types.</li>
</ol>

<p><img src="../fig/10X_QC_report_example.jpeg" width="800px" alt="10X Genomics QC Report" /></p>

<p>When you run a sample that has a problem of some kind, the CellRanger 
report might be able to detect something anomalous about your data and
present you with a warning. Here are two examples of reports with
warning flags highlighted.</p>

<p>In the report below, CellRanger notes that a low fraction of reads are within
cells. This might be caused by, for example, very high levels of ambient
RNA.</p>

<p><img src="../fig/cellranger_bad1.png" width="600px" alt="Bad 10X Genomics QC Report 1" /></p>

<p>In the report below, CellRanger notes that a low fraction of reads are 
confidently mapped to the transcriptome, and a high fraction of reads map
antisense to genes. Note that in this sample we are seeing only 249 genes
per cell despite a mean of over 90,000 reads per cell. This likely indicates
a poor quality library.</p>

<p><img src="../fig/cellranger_bad2.png" width="600px" alt="Bad 10X Genomics QC Report 1" /></p>

<h3 id="reading-a-cellranger-gene-expression-count-matrix-using-seurat">Reading a CellRanger Gene Expression Count Matrix using Seurat</h3>

<p>In order to read these files into memory, we will use the 
<a href="https://satijalab.org/seurat/reference/read10x">Seurat::Read10X()</a> function. 
This function searches for the three files mentioned above in the directory that
you pass in. Once it verifies that all three files are present, it reads them 
in to create a counts matrix with genes in rows and cells in columns.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">Seurat</span><span class="p">)</span><span class="w">
</span><span class="n">data_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'data'</span><span class="w">
</span></code></pre></div></div>

<p>We will use the <code class="language-plaintext highlighter-rouge">gene.column = 1</code> argument to tell Seurat to use the first 
column in ‘features.tsv.gz’ as the gene identifier.</p>

<p>Run the following command. This may take up to three minutes to complete.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># uses the Seurat function Read10X()</span><span class="w">
</span><span class="n">counts</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Read10X</span><span class="p">(</span><span class="n">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s1">'mouseStSt_invivo'</span><span class="p">),</span><span class="w"> </span><span class="n">gene.column</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">counts</code> now contains the sequencing read counts for each gene and cell.</p>

<p>How many rows and columns are there in <code class="language-plaintext highlighter-rouge">counts</code>?</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">dim</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 31053 47743
</code></pre></div></div>

<p>In the <code class="language-plaintext highlighter-rouge">counts</code> matrix, genes are in rows and cells are in columns. Let’s look 
at the first few gene names.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">rownames</span><span class="p">(</span><span class="n">counts</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [1] "Xkr4"    "Gm1992"  "Gm37381" "Rp1"     "Sox17"   "Gm37323" "Mrpl15" 
 [8] "Lypla1"  "Gm37988" "Tcea1"  
</code></pre></div></div>

<p>As you can see, the gene names are gene symbols. There is some risk that these 
may not be unique. Let’s check whether any of the gene symbols are duplicated. 
We will sum the number of duplicated gene symbols.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">sum</span><span class="p">(</span><span class="n">duplicated</span><span class="p">(</span><span class="n">rownames</span><span class="p">(</span><span class="n">counts</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 0
</code></pre></div></div>

<p>The sum equals zero, so there are no duplicated gene symbols, which is good.
As it turns out, the reference genome/annotation files that are prepared for
use by CellRanger have already been filtered to ensure no duplicated gene
symbols.</p>

<p>Let’s look at the cell identifiers in the column names.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">colnames</span><span class="p">(</span><span class="n">counts</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [1] "AAACGAATCCACTTCG-2" "AAAGGTACAGGAAGTC-2" "AACTTCTGTCATGGCC-2"
 [4] "AATGGCTCAACGGTAG-2" "ACACTGAAGTGCAGGT-2" "ACCACAACAGTCTCTC-2"
 [7] "ACGATGTAGTGGTTCT-2" "ACGCACGCACTAACCA-2" "ACTGCAATCAACTCTT-2"
[10] "ACTGCAATCGTCACCT-2"
</code></pre></div></div>

<p>Each of these barcodes identifies one cell. They should all be unique. Once 
again, let’s verify this.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">sum</span><span class="p">(</span><span class="n">duplicated</span><span class="p">(</span><span class="n">colnames</span><span class="p">(</span><span class="n">counts</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 0
</code></pre></div></div>

<p>The sum of duplicated values equals zero, so all of the barcodes are unique.
The barcode sequence is the actual sequence of the oligonucleotide tag that
was attached to the GEM (barcoded bead) that went into each droplet. In early
versions of 10X technology there were approximately 
<a href="https://kb.10xgenomics.com/hc/en-us/articles/115004506263-What-is-a-barcode-whitelist-">750,000 barcodes</a> 
per run while in the current chemistry there are 
<a href="https://kb.10xgenomics.com/hc/en-us/articles/360031133451-Why-is-there-a-discrepancy-in-the-3M-february-2018-txt-barcode-whitelist-">&gt;3 million barcodes</a>.
CellRanger attempts to correct sequencing errors in the barcodes
and uses a “whitelist” of known barcodes (in the 10X chemistry) to help.</p>

<p>Next, let’s look at the values in <code class="language-plaintext highlighter-rouge">counts</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counts</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10 x 20 sparse Matrix of class "dgCMatrix"
</code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [[ suppressing 20 column names 'AAACGAATCCACTTCG-2', 'AAAGGTACAGGAAGTC-2', 'AACTTCTGTCATGGCC-2' ... ]]
</code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                               
Xkr4    . . . . . . . . . . . . . . . . . . . .
Gm1992  . . . . . . . . . . . . . . . . . . . .
Gm37381 . . . . . . . . . . . . . . . . . . . .
Rp1     . . . . . . . . . . . . . . . . . . . .
Sox17   . . 2 4 . . . 1 . 1 1 . . 2 . . 1 8 1 .
Gm37323 . . . . . . . . . . . . . . . . . . . .
Mrpl15  . . . 1 1 . . . 1 . 2 . . . . 1 . 1 1 .
Lypla1  . . 2 1 . 1 1 . . . 1 1 2 . 1 1 1 . . .
Gm37988 . . . . . . . . . . . . . . . . . . . .
Tcea1   . . 2 . 2 2 . . 1 2 . 2 2 . . 2 1 1 2 .
</code></pre></div></div>

<p>We can see the gene symbols in rows along the left. The barcodes are not shown 
to make the values easier to read. Each of the periods represents a zero. The 
‘1’ values represent a single read for a gene in one cell.</p>

<p>Although <code class="language-plaintext highlighter-rouge">counts</code> looks like a matrix and you can use many matrix functions on 
it, <code class="language-plaintext highlighter-rouge">counts</code> is actually a <em>different</em> type of object. In scRNASeq, the read 
depth in each cell is quite low. So you many only get counts for a small number 
of genes in each cell. The <code class="language-plaintext highlighter-rouge">counts</code> matrix has 31053 rows and 
47743 columns, and includes 1.4825634 × 10<sup>9</sup> 
entries. However, most of these entries 
(92.4930544%) are 
zeros because every gene is not detected in every cell. It would be wasteful 
to store all of these zeros in memory. It would also make it difficult to 
store all of the data in memory. So <code class="language-plaintext highlighter-rouge">counts</code> is a ‘sparse matrix’, which only 
stores the positions of non-zero values in memory.</p>

<p>Look at the structure of the <code class="language-plaintext highlighter-rouge">counts</code> matrix using <a href="https://stat.ethz.ch/R-manual/R-devel/library/utils/html/str.html">str</a>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Formal class 'dgCMatrix' [package "Matrix"] with 6 slots
  ..@ i       : int [1:111295227] 15 19 36 38 40 61 66 67 70 93 ...
  ..@ p       : int [1:47744] 0 3264 6449 9729 13446 16990 20054 23142 26419 29563 ...
  ..@ Dim     : int [1:2] 31053 47743
  ..@ Dimnames:List of 2
  .. ..$ : chr [1:31053] "Xkr4" "Gm1992" "Gm37381" "Rp1" ...
  .. ..$ : chr [1:47743] "AAACGAATCCACTTCG-2" "AAAGGTACAGGAAGTC-2" "AACTTCTGTCATGGCC-2" "AATGGCTCAACGGTAG-2" ...
  ..@ x       : num [1:111295227] 1 1 1 2 1 6 1 1 2 1 ...
  ..@ factors : list()
</code></pre></div></div>

<p>We can see that the formal class name is a “dgCMatrix”. There are two long 
vectors of integers which encode the positions of non-zero values. The gene 
names and cell barcodes are stored in character vectors and the non-zero values 
are an integer vector. This class saves space by not allocating memory to store 
all of the zero values.</p>

<p>Let’s look at small portion of <code class="language-plaintext highlighter-rouge">counts</code>. We will create a tile plot indicating 
which values are non-zero for the first 100 cells and genes in rows 400 to 600. 
For historical reasons, R plots the rows along the X-axis and columns along the 
Y-axis. We will transpose the matrix so that genes are on the Y-axis, which 
reflects the way in which we normally look at this matrix.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">image</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">400</span><span class="o">:</span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">as.matrix</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="m">400</span><span class="o">:</span><span class="m">600</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> 
      </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cells'</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Genes'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="figure" style="text-align: center">
<img src="../fig/rmd-03-counts_image-1.png" alt="plot of chunk counts_image" width="612" />
<p class="caption">plot of chunk counts_image</p>
</div>

<p>In the tile plot above, each row represents one gene and each column represents 
one cell. Red indicates non-zero values and yellow indicates zero values.  As 
you can see, most of the matrix consists of zeros (yellow tiles) and hence is 
called ‘sparse’. You can also see that some genes are expressed in most cells, 
indicated by the horizontal red lines, and that some genes are expressed in 
very few cells.</p>

<p>What proportion of genes have zero counts in all samples?</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gene_sums</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">gene_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rownames</span><span class="p">(</span><span class="n">counts</span><span class="p">),</span><span class="w">
                        </span><span class="n">sums</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix</span><span class="o">::</span><span class="n">rowSums</span><span class="p">(</span><span class="n">counts</span><span class="p">))</span><span class="w">
</span><span class="nf">sum</span><span class="p">(</span><span class="n">gene_sums</span><span class="o">$</span><span class="n">sums</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 7322
</code></pre></div></div>

<p>We can see that 7322 (24%) 
genes have no reads at all associated with them. In the next lesson, we will 
remove genes that have no counts in any cells.</p>

<p>Next, let’s look at the number of counts in each cell.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hist</span><span class="p">(</span><span class="n">Matrix</span><span class="o">::</span><span class="n">colSums</span><span class="p">(</span><span class="n">counts</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="figure" style="text-align: center">
<img src="../fig/rmd-03-cell_counts-1.png" alt="plot of chunk cell_counts" width="612" />
<p class="caption">plot of chunk cell_counts</p>
</div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Matrix</span><span class="o">::</span><span class="n">colSums</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">enframe</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">scale_x_log10</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="figure" style="text-align: center">
<img src="../fig/rmd-03-cell_counts-2.png" alt="plot of chunk cell_counts" width="612" />
<p class="caption">plot of chunk cell_counts</p>
</div>

<p>The range of counts covers several orders of magnitude, from 
500 to 3.32592 × 10<sup>5</sup>. We will need
to normalize for this large difference in sequencing depth,
which we will cover in the next lesson.</p>

<h3 id="sample-metadata">Sample Metadata</h3>

<p>Sample metadata refers to information about your samples that is not the 
“data”, i.e. the gene counts. This might include information such as sex, 
tissue, or treatment. In the case of the liver atlas data, the authors provided 
a metadata file for their samples.</p>

<p>The sample metadata file is a comma-separated variable (CSV) file, We will read 
it in using the readr 
<a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a> function.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">metadata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="n">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s1">'mouseStSt_invivo'</span><span class="p">,</span><span class="w"> </span><span class="s1">'annot_metadata_first.csv'</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rows: 47743 Columns: 4
── Column specification ───────────────────────────────────────────────────────────────────────────────────────────────
Delimiter: ","
chr (4): sample, cell, digest, typeSample

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre></div></div>

<p>Let’s look at the top of the metadata.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 6 × 4
  sample cell               digest typeSample
  &lt;chr&gt;  &lt;chr&gt;              &lt;chr&gt;  &lt;chr&gt;     
1 CS48   AAACGAATCCACTTCG-2 inVivo scRnaSeq  
2 CS48   AAAGGTACAGGAAGTC-2 inVivo scRnaSeq  
3 CS48   AACTTCTGTCATGGCC-2 inVivo scRnaSeq  
4 CS48   AATGGCTCAACGGTAG-2 inVivo scRnaSeq  
5 CS48   ACACTGAAGTGCAGGT-2 inVivo scRnaSeq  
6 CS48   ACCACAACAGTCTCTC-2 inVivo scRnaSeq  
</code></pre></div></div>

<p>In the table above, you can see that there are four columns:</p>

<ol>
  <li>sample: mouse identifier from which cell was derived;</li>
  <li>cell: the DNA bar code used to identify the cell;</li>
  <li>digest: cells for this liver atlas were harvested using either an <em>in vivo</em> 
or an <em>ex vivo</em> procedure. In this subset of the data we are looking only 
at <em>in vivo</em> samples;</li>
  <li>typeSample: the type of library preparation protocol, either single cell 
RNA-seq (scRnaSeq) or nuclear sequencing (nucSeq). In this subset of the data 
we are looking only at scRnaSeq samples.</li>
</ol>

<p>Let’s confirm that we are only looking at scRnaSeq samples from <em>in vivo</em> 
digest cells:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dplyr</span><span class="o">::</span><span class="n">count</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">digest</span><span class="p">,</span><span class="w"> </span><span class="n">typeSample</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 1 × 3
  digest typeSample     n
  &lt;chr&gt;  &lt;chr&gt;      &lt;int&gt;
1 inVivo scRnaSeq   47743
</code></pre></div></div>

<p>We’re going to explore the data further using a series of Challenges. 
You will be asked to look at the contents of some of the columns to see 
how the data are 
distributed.</p>

<blockquote class="challenge">
  <h2 id="challenge-2">Challenge 2</h2>
  <p>How many mice were used to produce this data? The “sample” column contains 
the mouse identifier for each cell.</p>

  <blockquote class="solution">
    <h2 id="solution-to-challenge-2">Solution to Challenge 2</h2>

    <p>count(metadata, sample) %&gt;% summarize(total = n())</p>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="challenge-3">Challenge 3</h2>
  <p>How many cells are there from each mouse?</p>

  <blockquote class="solution">
    <h2 id="solution-to-challenge-3">Solution to Challenge 3</h2>

    <p>count(metadata, sample)</p>
  </blockquote>
</blockquote>

<p>In this workshop, we will attempt to reproduce some of the results of the 
<a href="https://livercellatlas.org/index.php">Liver Atlas</a> using Seurat. We will 
analyze the <em>in-vivo</em> single <strong>cell</strong> RNA-Seq 
together.</p>

<h3 id="save-data-for-next-lesson">Save Data for Next Lesson</h3>

<p>We will use the <em>in-vivo</em> data in the next lesson. 
If you plan to keep your RStudio open, we will simply continue to the next
lesson. If you wanted to save the data you could execute a command like:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">save</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s1">'lesson03.Rdata'</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<blockquote class="challenge">
  <h2 id="challenge-5">Challenge 5</h2>
  <p>In the lesson above, you read in the scRNASeq data. There is 
another dataset which was created using an <em>ex vivo</em> digest in the 
<code class="language-plaintext highlighter-rouge">mouseStSt_exvivo</code> 
directory. Delete the <code class="language-plaintext highlighter-rouge">counts</code> and <code class="language-plaintext highlighter-rouge">metadata</code> objects from your environment. 
Then read in the counts and metadata from the <code class="language-plaintext highlighter-rouge">mouseStSt_exvivo</code> 
directory and save them to a file called ‘lesson03_challenge.Rdata’.</p>

  <blockquote class="solution">
    <h2 id="solution-to-challenge-5">Solution to Challenge 5</h2>

    <p><code class="language-plaintext highlighter-rouge"># Remove exising counts and metadata.</code><br />
<code class="language-plaintext highlighter-rouge">rm(counts, metadata)</code>
<code class="language-plaintext highlighter-rouge"># Read in new counts.</code><br />
<code class="language-plaintext highlighter-rouge">counts &lt;- Seurat::Read10X(file.path(data_dir, 'mouseStSt_exvivo'), gene.column = 1)</code><br />
<code class="language-plaintext highlighter-rouge"># Read in new metadata.</code><br />
<code class="language-plaintext highlighter-rouge">metadata &lt;- read_csv(file.path(data_dir, 'mouseStSt_exvivo', 'annot_metadata.csv'))</code><br />
<code class="language-plaintext highlighter-rouge"># Save data for next lesson.</code><br />
<code class="language-plaintext highlighter-rouge">save(counts, metadata, file = file.path(data_dir, 'lesson03_challenge.Rdata'))</code></p>
  </blockquote>
</blockquote>

<h3 id="session-info">Session Info</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sessionInfo</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R version 4.4.1 (2024-06-14)
Platform: x86_64-apple-darwin20
Running under: macOS 15.0.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] Seurat_5.1.0       SeuratObject_5.0.2 sp_2.1-4           lubridate_1.9.3   
 [5] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       
 [9] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     
[13] tidyverse_2.0.0    knitr_1.48        

loaded via a namespace (and not attached):
  [1] deldir_2.0-4           pbapply_1.7-2          gridExtra_2.3         
  [4] rlang_1.1.4            magrittr_2.0.3         RcppAnnoy_0.0.22      
  [7] spatstat.geom_3.3-3    matrixStats_1.4.1      ggridges_0.5.6        
 [10] compiler_4.4.1         png_0.1-8              vctrs_0.6.5           
 [13] reshape2_1.4.4         crayon_1.5.3           pkgconfig_2.0.3       
 [16] fastmap_1.2.0          labeling_0.4.3         utf8_1.2.4            
 [19] promises_1.3.0         tzdb_0.4.0             bit_4.5.0             
 [22] xfun_0.48              jsonlite_1.8.9         goftest_1.2-3         
 [25] highr_0.11             later_1.3.2            spatstat.utils_3.1-0  
 [28] irlba_2.3.5.1          parallel_4.4.1         cluster_2.1.6         
 [31] R6_2.5.1               ica_1.0-3              spatstat.data_3.1-2   
 [34] stringi_1.8.4          RColorBrewer_1.1-3     reticulate_1.39.0     
 [37] spatstat.univar_3.0-1  parallelly_1.38.0      lmtest_0.9-40         
 [40] scattermore_1.2        Rcpp_1.0.13            tensor_1.5            
 [43] future.apply_1.11.2    zoo_1.8-12             R.utils_2.12.3        
 [46] sctransform_0.4.1      httpuv_1.6.15          Matrix_1.7-0          
 [49] splines_4.4.1          igraph_2.0.3           timechange_0.3.0      
 [52] tidyselect_1.2.1       abind_1.4-8            spatstat.random_3.3-2 
 [55] codetools_0.2-20       miniUI_0.1.1.1         spatstat.explore_3.3-2
 [58] listenv_0.9.1          lattice_0.22-6         plyr_1.8.9            
 [61] shiny_1.9.1            withr_3.0.1            ROCR_1.0-11           
 [64] evaluate_1.0.1         Rtsne_0.17             future_1.34.0         
 [67] fastDummies_1.7.4      survival_3.6-4         polyclip_1.10-7       
 [70] fitdistrplus_1.2-1     pillar_1.9.0           KernSmooth_2.23-24    
 [73] plotly_4.10.4          generics_0.1.3         vroom_1.6.5           
 [76] RcppHNSW_0.6.0         hms_1.1.3              munsell_0.5.1         
 [79] scales_1.3.0           globals_0.16.3         xtable_1.8-4          
 [82] glue_1.8.0             lazyeval_0.2.2         tools_4.4.1           
 [85] data.table_1.16.2      RSpectra_0.16-2        RANN_2.6.2            
 [88] leiden_0.4.3.1         dotCall64_1.2          cowplot_1.1.3         
 [91] grid_4.4.1             colorspace_2.1-1       nlme_3.1-164          
 [94] patchwork_1.3.0        cli_3.6.3              spatstat.sparse_3.1-0 
 [97] spam_2.11-0            fansi_1.0.6            viridisLite_0.4.2     
[100] uwot_0.2.2             gtable_0.3.5           R.methodsS3_1.8.2     
[103] digest_0.6.37          progressr_0.14.0       ggrepel_0.9.6         
[106] htmlwidgets_1.6.4      farver_2.1.2           R.oo_1.26.0           
[109] htmltools_0.5.8.1      lifecycle_1.0.4        httr_1.4.7            
[112] mime_0.12              bit64_4.5.2            MASS_7.3-60.2         
</code></pre></div></div>






<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>CellRanger produces a gene expression count matrix that can be read in using Seurat.</p>
</li>
    
    <li><p>The count matrix is stored as a sparse matrix with features in rows and cells in columns.</p>
</li>
    
  </ul>
</blockquote>

</article>


















  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../02-Experimental-Considerations/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../04-Quality-Control/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <div class="row">
    <div class="col-md-6 license" id="license-info" align="left">
	
	Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2018–2024
	by <a href="https://carpentries.org/">The Carpentries</a>
        <br>
        Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2016–2018
	by <a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	
	<a href="/edit//_episodes_rmd/03-Overview-scRNA-seq-Data.Rmd" data-checker-ignore>Edit on GitHub</a>
	
	
	/
	<a href="/blob//CONTRIBUTING.md" data-checker-ignore>Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION" data-checker-ignore>Cite</a>
	/
	<a href="mailto:team@carpentries.org">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>


<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io"]]);
  _paq.push(["setDoNotTrack", true]);
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://carpentries.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->


<script src="../assets/js/anchor.min.js"></script>
<script>
    anchors.add();
</script>

  </body>
</html>
